# Payment System - Visual Flow Guide

## ğŸ“Š User Journey: Initial Booking

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    PARKING LOT PAGE                             â”‚
â”‚  User browsing available slots                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â†“
                    User clicks slot
                           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   PAYMENT MODAL                                 â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ ğŸ’³ Complete Payment                              âœ•       â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚                                                          â”‚ â”‚
â”‚  â”‚ ğŸ“ Parking Lot: Main Street Lot                        â”‚ â”‚
â”‚  â”‚ ğŸ”¢ Slot Number: #5                                    â”‚ â”‚
â”‚  â”‚ ğŸš— Vehicle Type: Sedan                                â”‚ â”‚
â”‚  â”‚ ğŸ’° Amount: â‚¹50                                        â”‚ â”‚
â”‚  â”‚                                                          â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚                                                          â”‚ â”‚
â”‚  â”‚ â±ï¸ Duration: 1 Hour                                    â”‚ â”‚
â”‚  â”‚ ğŸ”„ Renewal available: Yes                              â”‚ â”‚
â”‚  â”‚                                                          â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚                                                          â”‚ â”‚
â”‚  â”‚ â—‹ ğŸ’³ Credit Card                                       â”‚ â”‚
â”‚  â”‚     Instant payment                                    â”‚ â”‚
â”‚  â”‚                                                          â”‚ â”‚
â”‚  â”‚ â— ğŸ“± UPI / QR Code                         âœ“            â”‚ â”‚
â”‚  â”‚     Instant payment                                    â”‚ â”‚
â”‚  â”‚                                                          â”‚ â”‚
â”‚  â”‚ â—‹ ğŸ’µ Cash                                              â”‚ â”‚
â”‚  â”‚     Payment at counter                                 â”‚ â”‚
â”‚  â”‚                                                          â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚ â˜‘ï¸ I agree to terms and conditions                     â”‚ â”‚
â”‚  â”‚                                                          â”‚ â”‚
â”‚  â”‚ [Cancel]  [Confirm Payment]                            â”‚ â”‚
â”‚  â”‚                                                          â”‚ â”‚
â”‚  â”‚ ğŸ” Your payment is secure and encrypted                â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â†“
                    User confirms payment
                           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  API CALL (with loading state)                                  â”‚
â”‚  POST /parking/bookings/                                        â”‚
â”‚  {slot, vehicle_number, booking_type,                          â”‚
â”‚   payment_method: "UPI", amount: 50}                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  BACKEND PROCESSING (Atomic Transaction)                        â”‚
â”‚                                                                 â”‚
â”‚  1. âœ“ Create Booking (status='booked')                         â”‚
â”‚  2. âœ“ Mark slot unavailable                                    â”‚
â”‚  3. âœ“ Create Payment (status='SUCCESS', txn_id='PM-123-...')  â”‚
â”‚  4. âœ“ Return response with nested Payment                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              BOOKING CONFIRMATION PAGE                          â”‚
â”‚                                                                 â”‚
â”‚  âœ… Booking Confirmed                                          â”‚
â”‚  Your parking slot has been reserved                           â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ ğŸ…¿ï¸ Lot Name: Main Street Lot                           â”‚ â”‚
â”‚  â”‚ ğŸ”¢ Slot Number: #5                                     â”‚ â”‚
â”‚  â”‚ ğŸš— Vehicle: TN01AB1234                                â”‚ â”‚
â”‚  â”‚ ğŸ’° Price: â‚¹50                                         â”‚ â”‚
â”‚  â”‚ â±ï¸ Booking Type: Instant                              â”‚ â”‚
â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚ â”‚
â”‚  â”‚ ğŸ’³ Payment Method: ğŸ“± UPI / QR Code                  â”‚ â”‚
â”‚  â”‚ ğŸ’° Payment Amount: â‚¹50                               â”‚ â”‚
â”‚  â”‚ ğŸ“Š Payment Status: âœ… Payment Successful             â”‚ â”‚
â”‚  â”‚ ğŸ” Transaction ID: PM-123-1736485200                 â”‚ â”‚
â”‚  â”‚                                                       â”‚ â”‚
â”‚  â”‚ ğŸ§¼ Car Wash Service: Not selected                    â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                             â”‚
â”‚  â±ï¸ Time Remaining                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚        59:45:23                                      â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                             â”‚
â”‚  ğŸ’¡ Your booking will automatically expire in 1 hour.     â”‚
â”‚     After expiration, the slot will be released.          â”‚
â”‚                                                             â”‚
â”‚  [ğŸš— Add Car Wash Service]  [ğŸ”„ Renew Booking]          â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ User Journey: Renewal

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              BOOKING CONFIRMATION PAGE                          â”‚
â”‚  (After 55 minutes - booking expiring soon)                    â”‚
â”‚                                                                 â”‚
â”‚  â±ï¸ Time Remaining                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚        04:23:15   âš ï¸ EXPIRING SOON                      â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                 â”‚
â”‚  [ğŸš— Add Car Wash Service]  [ğŸ”„ Renew Booking]          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â†“
                   User clicks "Renew Booking"
                           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   PAYMENT MODAL (Renewal)                       â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ ğŸ’³ Complete Payment                              âœ•       â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚                                                          â”‚ â”‚
â”‚  â”‚ ğŸ“ Parking Lot: Main Street Lot                        â”‚ â”‚
â”‚  â”‚ ğŸ”¢ Slot Number: #5                                    â”‚ â”‚
â”‚  â”‚ ğŸš— Vehicle Type: Sedan                                â”‚ â”‚
â”‚  â”‚ ğŸ’° Amount: â‚¹50                                        â”‚ â”‚
â”‚  â”‚                                                          â”‚ â”‚
â”‚  â”‚ Select payment method:                                  â”‚ â”‚
â”‚  â”‚                                                          â”‚ â”‚
â”‚  â”‚ â—‹ ğŸ’³ Credit Card                                       â”‚ â”‚
â”‚  â”‚ â— ğŸ“± UPI / QR Code                         âœ“            â”‚ â”‚
â”‚  â”‚ â—‹ ğŸ’µ Cash                                              â”‚ â”‚
â”‚  â”‚                                                          â”‚ â”‚
â”‚  â”‚ [Cancel]  [Confirm Payment]                            â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â†“
                   User confirms (same method or new)
                           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  API CALL (Renewal)                                             â”‚
â”‚  POST /bookings/123/renew/                                     â”‚
â”‚  {payment_method: "UPI", amount: 50}                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  BACKEND PROCESSING (Atomic Transaction)                        â”‚
â”‚                                                                 â”‚
â”‚  1. âœ“ Validate original booking is expired                     â”‚
â”‚  2. âœ“ Check slot is available                                  â”‚
â”‚  3. âœ“ Create new Booking (status='booked')                     â”‚
â”‚  4. âœ“ Mark slot unavailable                                    â”‚
â”‚  5. âœ“ Create Payment for new booking                           â”‚
â”‚  6. âœ“ Return new booking with payment                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              NEW BOOKING CONFIRMATION PAGE                      â”‚
â”‚                                                                 â”‚
â”‚  âœ… Booking Confirmed (Renewed)                                â”‚
â”‚  Your parking slot has been reserved for another hour         â”‚
â”‚                                                                 â”‚
â”‚  Payment Details:                                               â”‚
â”‚  â”œâ”€ Payment Method: ğŸ“± UPI / QR Code                           â”‚
â”‚  â”œâ”€ Status: âœ… Payment Successful                              â”‚
â”‚  â”œâ”€ Transaction ID: PM-124-1736488800                          â”‚
â”‚  â””â”€ Amount: â‚¹50                                               â”‚
â”‚                                                                 â”‚
â”‚  â±ï¸ Time Remaining: 59:59:45 (Full hour - Timer Reset!)       â”‚
â”‚                                                                 â”‚
â”‚  [ğŸš— Add Car Wash Service]  [ğŸ”„ Renew Booking]          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ’¾ Database Schema Visualization

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    PARKING_BOOKING TABLE                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ booking_id (PK) â”‚ 123                                           â”‚
â”‚ user_id (FK)    â”‚ 5                                             â”‚
â”‚ slot_id (FK)    â”‚ 1                                             â”‚
â”‚ lot_id (FK)     â”‚ 10                                            â”‚
â”‚ vehicle_number  â”‚ TN01AB1234                                    â”‚
â”‚ booking_type    â”‚ Instant                                       â”‚
â”‚ status          â”‚ booked  (lowercase standardized)              â”‚
â”‚ start_time      â”‚ 2025-01-10 10:30:00                          â”‚
â”‚ end_time        â”‚ 2025-01-10 11:30:00                          â”‚
â”‚ price           â”‚ 50.00                                        â”‚
â”‚ created_at      â”‚ 2025-01-10 10:30:45                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â†‘
           â”‚ OneToOneField (one payment per booking)
           â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    PARKING_PAYMENT TABLE                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ pay_id (PK)      â”‚ 45                                           â”‚
â”‚ booking_id (FK)  â”‚ 123 (UNIQUE - one per booking)              â”‚
â”‚ user_id (FK)     â”‚ 5                                            â”‚
â”‚ payment_method   â”‚ UPI                                         â”‚
â”‚ amount           â”‚ 50.00                                       â”‚
â”‚ status           â”‚ SUCCESS  (instant methods)                   â”‚
â”‚ transaction_id   â”‚ PM-123-1736485200 (unique, traceable)      â”‚
â”‚ created_at       â”‚ 2025-01-10 10:30:45                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Data Relationships:
â”œâ”€ One User â†’ Many Bookings (via user_id)
â”œâ”€ One Booking â†’ One Payment (OneToOneField)
â”œâ”€ One Slot â†’ Many Bookings (historical)
â”œâ”€ One Slot â†’ One Active Booking (business logic)
â””â”€ Payment exists only if Booking exists
```

---

## ğŸ”„ Payment Status Flow

```
Payment Creation
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ User selects method    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Is it Cash?     â”‚
    â””â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”˜
      â”‚ NO          â”‚ YES
      â†“             â†“
   SUCCESS       PENDING
   (Instant)     (At Counter)
      â†“             â†“
   âœ… Green      â³ Orange
   Badge         Badge
```

---

## ğŸ¯ API Response Structure

```json
{
  "booking_id": 123,
  "status": "booked",
  "start_time": "2025-01-10T10:30:00Z",
  "end_time": "2025-01-10T11:30:00Z",
  "payment": {
    "pay_id": 45,
    "booking": 123,
    "user": 5,
    "payment_method": "UPI",
    "amount": "50.00",
    "status": "SUCCESS",
    "transaction_id": "PM-123-1736485200",
    "created_at": "2025-01-10T10:30:45Z"
  }
}

Key Features:
â”œâ”€ Payment nested in Booking response
â”œâ”€ Payment included by default (no separate request needed)
â”œâ”€ Status values standardized (lowercase)
â”œâ”€ Transaction ID unique and traceable
â””â”€ Timestamp shows exact creation time
```

---

## ğŸ“± Mobile Layout

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   PAYMENT MODAL         â”‚
â”‚  (Phone Portrait)       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ’³ Complete Payment âœ•  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                         â”‚
â”‚ Parking Lot:            â”‚
â”‚ Main Street Lot         â”‚
â”‚                         â”‚
â”‚ Slot Number: #5         â”‚
â”‚ Vehicle: Sedan          â”‚
â”‚ Amount: â‚¹50             â”‚
â”‚                         â”‚
â”‚ Duration: 1 Hour        â”‚
â”‚                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ’³ Credit Card          â”‚
â”‚    Instant              â”‚
â”‚                         â”‚
â”‚ ğŸ“± UPI / QR Code    âœ“   â”‚
â”‚    Instant              â”‚
â”‚                         â”‚
â”‚ ğŸ’µ Cash                 â”‚
â”‚    At Counter           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â˜‘ï¸ I agree to terms    â”‚
â”‚                         â”‚
â”‚ [Cancel]                â”‚
â”‚ [Confirm Payment]       â”‚
â”‚                         â”‚
â”‚ ğŸ” Secure & Encrypted  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## âœ… Component State Diagram

```
DynamicLot Component
â”œâ”€ State: showPaymentModal
â”‚  â”œâ”€ false â†’ Shows slots list
â”‚  â””â”€ true â†’ Shows PaymentModal
â”œâ”€ State: isBooking
â”‚  â”œâ”€ false â†’ Buttons enabled
â”‚  â””â”€ true â†’ Loading state, buttons disabled
â””â”€ Handler: handlePaymentConfirm(paymentData)
   â””â”€ Sends payment_method + amount to API

BookingConfirmation Component
â”œâ”€ State: showRenewalPaymentModal
â”‚  â”œâ”€ false â†’ Shows booking details
â”‚  â””â”€ true â†’ Shows PaymentModal for renewal
â”œâ”€ State: isRenewing
â”‚  â”œâ”€ false â†’ Renewal button enabled
â”‚  â””â”€ true â†’ Loading state
â”œâ”€ Data: booking (includes payment)
â”‚  â””â”€ Displays payment info if exists
â””â”€ Handler: handleRenewalPaymentConfirm()
   â””â”€ Sends payment_method + amount to renew API
```

---

## ğŸš€ Deployment Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   PRODUCTION                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                     â”‚
â”‚  Frontend (React/Vite)                             â”‚
â”‚  â”œâ”€ DynamicLot.jsx (Booking page)                 â”‚
â”‚  â”œâ”€ PaymentModal.jsx (Payment UI)                 â”‚
â”‚  â””â”€ BookingConfirmation.jsx (Confirmation page)   â”‚
â”‚                                                     â”‚
â”‚  â†“â†‘ HTTP/HTTPS                                    â”‚
â”‚                                                     â”‚
â”‚  Backend (Django REST)                            â”‚
â”‚  â”œâ”€ /parking/bookings/ (Create with payment)      â”‚
â”‚  â”œâ”€ /bookings/{id}/renew/ (Renew with payment)   â”‚
â”‚  â”œâ”€ PaymentViewSet (Payment endpoints)            â”‚
â”‚  â”œâ”€ Payment Model (Data storage)                  â”‚
â”‚  â””â”€ Atomic Transactions (Data integrity)          â”‚
â”‚                                                     â”‚
â”‚  â†“â†‘ ORM                                           â”‚
â”‚                                                     â”‚
â”‚  Database (SQLite/PostgreSQL)                     â”‚
â”‚  â”œâ”€ parking_booking table                         â”‚
â”‚  â”œâ”€ parking_payment table                         â”‚
â”‚  â””â”€ parking_slot table                            â”‚
â”‚                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

No External Dependencies:
â”œâ”€ âŒ No payment gateway API
â”œâ”€ âŒ No payment processor
â”œâ”€ âœ… Pure mock implementation
â””â”€ âœ… Easy to integrate real gateway later
```

---

## ğŸ” Security Flow

```
User Request
â”œâ”€ Check: Authentication token present?
â”‚  â”œâ”€ No â†’ 401 Unauthorized
â”‚  â””â”€ Yes â†’ Continue
â”œâ”€ Check: User owns the booking?
â”‚  â”œâ”€ No â†’ 403 Forbidden
â”‚  â””â”€ Yes â†’ Continue
â”œâ”€ Check: Valid input data?
â”‚  â”œâ”€ No â†’ 400 Bad Request
â”‚  â””â”€ Yes â†’ Continue
â””â”€ Create: Booking + Payment (Atomic)
   â”œâ”€ Success â†’ 201 Created
   â””â”€ Failure â†’ 500 Error (no partial state)

Secure Points:
â”œâ”€ Bearer token authentication
â”œâ”€ User ownership validation
â”œâ”€ Atomic transactions (no partial updates)
â”œâ”€ No sensitive payment data in logs
â””â”€ Transaction ID for audit trail
```

---

## ğŸ“Š Status Badge Colors

```
Payment Successful âœ…
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Background: #d1fae5 (light green)
â”‚ Text: #065f46 (dark green)
â”‚ Icon: âœ…
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Payment Pending â³
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Background: #fed7aa (light orange)
â”‚ Text: #92400e (dark orange)
â”‚ Icon: â³
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Payment Failed âŒ
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Background: #fee2e2 (light red)
â”‚ Text: #991b1b (dark red)
â”‚ Icon: âŒ
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¨ Color Scheme

```
Primary Colors:
â”œâ”€ Purple-Blue Gradient: #667eea â†’ #764ba2
â”‚  â””â”€ Used for: Header, buttons, highlights
â”œâ”€ Success Green: #059669 / #2e7d32
â”‚  â””â”€ Used for: Successful payments, status
â””â”€ Pending Orange: #ff9800 / #e65100
   â””â”€ Used for: Pending payments, alerts

Neutral Colors:
â”œâ”€ Background: #ffffff (white)
â”œâ”€ Text: #212529 (dark grey)
â”œâ”€ Border: #e5e7eb (light grey)
â””â”€ Disabled: #f0f0f0 (very light grey)
```

---

**This visual guide helps understand the complete payment flow from user perspective and system architecture perspective.**
